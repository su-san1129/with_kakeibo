<div class="row">
	<div class="col-3">
		<div class="container">
			<div class="card mb-3">
	      <div class="card-body text-center">
	        <p><%= attachment_image_tag current_user, :profile_image, :fill, 60, 60, class: "img-circle pull-left profile-img", fallback: "no_image.png" ,size: "100x100" %></p>
	        <h4 class="card-title"><%= current_user.name %></h4>
	        <p class="card-text"><%= current_user.introduction %></p>
	        <%= link_to "編集", edit_user_path(current_user), class: "btn btn-outline-dark" %>
	      </div>
		  </div>
		  <div class="card mb-5">
		  	<div class="card-body">
		  		<div class="card-title">新規投稿</div>
		  		<div class="card-text">
		  			<div class="form-group">
		  				<%= render 'variable_costs/new_form' %>
		  			</div>
		  		</div>
		  	</div>
		  </div>
		</div>
	</div>


	<div class="col-sm-6">

		<div class="row">
			<% if @chart_data.present? %>
			<div class="col-12">
				<div class="card">
				<%= pie_chart @chart_data %>
				</div>
			</div>
			<% else %>
			<div class="col-12">
				<div class="card chart-card">
				<%= pie_chart ({"食費" => 10, "交通費" => 5, "通信費" => 3}) %>
				</div>
				<div class="chart-text">
					<div class="chart-text-pdg">費用を追加するとグラフが表示されます。</div>
				</div>
			</div>
			<% end %>
			<div class="col-12 btn btn-outline-dark my-3">
				支出一覧　(暫定)
			</div>
		</div>
		<div class="row">
			<% @variable_costs.each do |v| %>
				<div class="col-sm-6">
					<div class="card my-2">
						<div class="card-body">
							<div class="card-text">
								<ul class="list-group list-group-flush">
									<li class="list-group-item">カテゴリー：<%= v.category.category %></li>
									<li class="list-group-item">金額：￥<%= number_with_delimiter(v.price) %></li>
									<li class="list-group-item">詳細：<%= v.opinion %></li>
									<li class="list-group-item">支払日：<%= v.payment_day.strftime('%Y/%m/%d') %></li>
								</ul>
								<p><%= link_to "削除", variable_cost_path(v.id), method: :delete %></p>
							</div>
						</div>
					</div>
				</div>
			<% end %>
		</div>
	</div>


	<div class="col-sm-3">
		<%= month_calendar events: @variable_costs do |date, variable_costs| %>
		  <%= date.day %>
		  <% sum = 0 %>
			  <% variable_costs.each do |variable_cost| %>
		    <div>
		      <% sum = sum + variable_cost.price %>
		    </div>
			 <% end %>
		  <% if sum != 0 %>
			  <%= sum %>
			<% end %>
		<% end %>
		<div class="container">
			<div class="card">
				<div class="card-body text-center">
					<div><%= render 'incomes/new_modal' %></div>
					<% if @income_price.present? && balance_price < 0 %>
						<div class="card-title">今月の給料</div>
						<div class="card-text">￥<%= number_with_delimiter(@income_price.income) %></div>
						<div class="card-title">今月の残額</div>
						<h2 class="card-text">￥<span class="text-danger"><%= number_with_delimiter(balance_price) %></span></h2>
					<% elsif @income_price.present? %>
					<div class="card-title">今月の給料</div>
						<div class="card-text">￥<%= number_with_delimiter(@income_price.income) %></div>
						<div class="card-title">今月の残額</div>
						<div class="card-text">￥<%= number_with_delimiter(balance_price) %></div>
					<% else %>
						<div class="card-title">今月の給料</div>
						<div class="card-text">登録はまだありません。</div>
					<% end %>
				</div>
			</div>

			<div class="card my-2">
				<div class="card-body">
					<div class="card-title">カテゴリー</div>
					<div class="card-text">
						<ul class="list-group list-group-flush">
							<% @categories.each do |category,count| %>
							<li class="list-group-item">
								<%= category %>(<%= count %>)
							</li>
							<% end %>
						</ul>
						<div><%= render 'categories/category_modal' %></div>
					</div>
				</div>
			</div>
		</div>
	</div>


</div>